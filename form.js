
const ASCII_OVO_TO_UNICODE_OVO = {
  'e~//': 'ê̤',
  'e~\\\\': 'ě̤',
  'e~': 'e̤',
  '(e~//)': 'ê̤',
  '(e~\\\\)': 'ě̤',
  '(e~)': 'é̤',
  'i_//': 'ị̂',
  'i_\\\\': 'ị̌',
  'i_': 'ị',
  '(i_//)': 'ị̂',
  '(i_\\\\)': 'ị̌',
  '(i_)': 'ı̣́',
  'e_//': 'ệ',
  'e_\\\\': 'ẹ̌',
  'e_': 'ẹ',
  '(e_//)': 'ẹ́̂',
  '(e_\\\\)': 'ẹ́̌',
  '(e_)': 'ẹ́',
  'a_//': 'ậ',
  'a_\\\\': 'ạ̌',
  'a_': 'ạ',
  '(a_//)': 'ạ́̂',
  '(a_\\\\)': 'ạ́̌',
  '(a_)': 'ạ́',
  'u_//': 'ụ̂',
  'u_\\\\': 'ụ̌',
  'u_': 'ụ',
  '(u_//)': 'ụ́̂',
  '(u_\\\\)': 'ụ́̌',
  '(u_)': 'ụ́',
  'o_//': 'ộ',
  'o_\\\\': 'ọ̌',
  'o_': 'ọ',
  '(o_)': 'ọ́',
  '(o_//)': 'ọ́̂',
  '(o_\\\\)': 'ọ́̌',
  'i~//': 'î̤',
  'i~\\\\': 'ǐ̤',
  'i~': 'i̤',
  '(i~//)': 'ı̤́̂',
  '(i~\\\\)': 'ı̤́̌',
  '(i~)': 'ı̤́',
  'u~': 'ṳ',
  'u~//': 'ṳ̂',
  'u~\\\\': 'ṳ̌',
  '(u~//)': 'ṳ́̂',
  '(u~\\\\)': 'ṳ́̌',
  '(u~)': 'ṳ́',
  'o~//': 'ô̤',
  'o~\\\\': 'ǒ̤',
  'o~': 'o̤',
  '(o~//)': 'ó̤̂',
  '(o~\\\\)': 'ó̤̌',
  '(o~)': 'ó̤',
  'i': 'i',
  'i//': 'î',
  'i\\\\': 'ǐ',
  '(i//)': 'ı́̂',
  '(i\\\\)': 'ı́̌',
  '(i)': 'ı́',
  'e//': 'ê',
  'e\\\\': 'ě',
  '(e//)': 'é̂',
  '(e\\\\)': 'é̌',
  'e': 'e',
  '(e)': 'é',
  'a//': 'â',
  'a\\\\': 'ǎ',
  'a': 'a',
  '(a//)': 'á̂',
  '(a\\\\)': 'á̌',
  '(a)': 'á',
  'a~//': 'â̤',
  'a~\\\\': 'ǎ̤',
  'a~': 'a̤',
  '(a~//)': 'á̤̂',
  '(a~\\\\)': 'á̤̌',
  '(a~)': 'á̤',
  'o//': 'ô',
  'o\\\\': 'ǒ',
  'o': 'o',
  '(o//)': 'ó̂',
  '(o\\\\)': 'ó̌',
  '(o)': 'ó',
  'u//': 'û',
  'u\\\\': 'ǔ',
  'u': 'u',
  '(u//)': 'ú̂',
  '(u\\\\)': 'ú̌',
  '(u)': 'ú',
  'm_': 'ṃ',
  'm': 'm',
  'n_': 'ṇ',
  'n': 'n',
  'q': 'q',
  'g?': 'g̀',
  'g': 'g',
  '\'': '\'',
  '"': '"',
  'd!': 'd̖',
  'd?': 'd̗',
  'd*': 'd̬',
  'd_': 'ḍ',
  'd': 'd',
  'b?': 'b̗',
  'b!': 'b̖',
  'b': 'b',
  'p!': 'ṕ',
  'p*': 'p̂',
  'p': 'p',
  't_': 'ṭ',
  't!': 't̖',
  't~': 't̤',
  't*': 't̬',
  't': 't',
  'k!': 'k̖',
  'k*': 'k̬',
  'k_': 'ḳ',
  'k': 'k',
  'h~': 'h̤',
  'h_': 'ḥ',
  'h': 'h',
  'j_': 'ȷ̈',
  'j': 'j',
  'j': 'j',
  's_': 'ṣ',
  's~': 's̤',
  's': 's',
  'f_': 'f̣',
  'f': 'f',
  'v_': 'ṿ',
  'v~': 'v̤',
  'v': 'v',
  'z': 'z',
  'c~': 'c̤',
  'c_': 'c̣',
  'c': 'c',
  'l_': 'ḷ',
  'l*': 'l̬',
  'l~': 'l̤',
  'l': 'l',
  'r~': 'r̤',
  'r_': 'ṛ',
  'r': 'r',
  'x~': 'x̤',
  'x_': 'x̣',
  'x': 'x',
  'w': 'w',
  'y': 'y',
}

const IPA_TO_ASCII_OVO = {
  'i': 'i',
  'iː': 'ii',
  'ɪ': 'I',
  'ɨ': 'i@',
  'e': 'e',
  'eː': 'ee',
  'ø': 'e@',
  'ɛ': 'E',
  'ɛː': 'EE',
  'ɛ̃': 'E~',
  'ɚ': 'E@',
  'ɜ': 'E@',
  'ɝ': 'E@',
  'ɑ': 'a',
  'ɑː': 'aa',
  'aː': 'aa',
  'ɑ̃': 'a~',
  'æ': 'A',
  'æː': 'AA',
  'ɒ': 'A',
  'ɒː': 'AA',
  'o': 'o',
  'oː': 'o',
  'ɔ': 'o@',
  'ɔ̃': 'o@~',
  'ɵ': 'O',
  'ʊ': 'O',
  'ʏ': 'O',
  'u': 'u',
  'uː': 'uu',
  'ʉ': 'u@',
  'ɯ': 'u@',
  'ʌ': 'U',
  'ə': 'U',
  'œ': 'U@',
  'b': 'b',
  'bː': 'bb',
  'bʲ': 'by',
  'bʱ': 'bhh',
  'bˠ': 'br@',
  'ɓ': 'b?',
  'ʙ': 'b!b!',
  'd': 'd',
  'dː': 'dd',
  'dˤ': 'd"@',
  'dˠ': 'dr@',
  'dʱ': 'dhh',
  'dʲ': 'dy',
  'ɖ': 'D',
  'ɖʱ': 'Dhh',
  'd͡ʒ': 'dj',
  'dʒ': 'dj',
  'dʒʱ': 'djhh',
  'd͡z': 'dz',
  'dz': 'dz',
  'd͡ʑ': 'djy',
  'dʑ': 'djy',
  'd͡ʐ': 'dJ',
  'dʐ': 'dJ',
  'θ': 'c',
  'θˤ': 'c"@',
  'ð': 'C',
  'ðˤ': 'C"@',
  'f': 'f',
  'ɸ': 'F',
  'fʲ': 'fy',
  'g': 'g',
  'ɢ': 'g',
  'ɡʱ': 'ghh',
  'ɠ': 'g?',
  'ʛ': 'g?',
  'ɡʲ': 'gy',
  'ɟ': 'gy',
  'ʄ': 'g?y',
  'h': 'h',
  'ħ': 'h"@',
  'ɦ': 'hh',
  'x': 'H',
  'xʲ': 'Hy',
  'χ': 'h@',
  'ç': 'hy',
  'ʒ': 'j',
  'ʐ': 'J',
  'ɮ': 'j@',
  'ʑ': 'jy',
  'ʑː': 'jjy',
  'k': 'k',
  'k\'': 'k!',
  'kː': 'kk',
  'kʰ': 'kh',
  'kʷ': 'kw',
  'kʷʰ': 'kwh',
  'kʲ': 'ky',
  'q': 'K',
  'qʰ': 'Kh',
  'q\'': 'K!',
  'qʷʰ': 'Kwh',
  'q\'ʷ': 'K!w',
  'm': 'm',
  'mː': 'mm',
  'm̥': 'mh',
  'mʰ': 'mh',
  'mʲ': 'my',
  'mˠ': 'mr@',
  'mʱ': 'mhh',
  'n': 'n',
  'nː': 'nn',
  'ɳ': 'N',
  'ŋ': 'q',
  'ɴ': 'q',
  'nʲ': 'ny',
  'ɲ': 'ny',
  'n̥': 'nh',
  'ŋ̊': 'qh',
  'l': 'l',
  'lː': 'll',
  'ɭ': 'L',
  'ɬ': 'l@',
  'ɫ': 'lr@',
  'lˠ': 'lr@',
  'lʲ': 'ly',
  'ʎ': 'ly',
  'p': 'p',
  'pː': 'pp',
  'p\'': 'p!',
  'pˠ': 'pr@',
  'pʲ': 'py',
  'r': 'r',
  'r̥': 'rh',
  'ɽ': 'R',
  'ɾˠ': 'rr@',
  'ɾʲ': 'ry',
  'ɣ': 'r@',
  'ʁ': 'r@',
  's': 's',
  'sː': 'ss',
  'sˤ': 's"@',
  'sˠ': 'sr@',
  't': 't',
  'tː': 'tt',
  'ʈ': 'T',
  'tʰ': 'th',
  'ʈʰ': 'Th',
  'tˤ': 't"@',
  'tˠ': 'tr@',
  'tʲ': 'ty',
  't͡ɬ': 'tl@',
  't͡ɬʰ': 'tl@h',
  't͡ɬ\'': 't!l@',
  't͡s': 'ts',
  'ts': 'ts',
  't͡sʰ': 'tsh',
  'tsh': 'tsh',
  't͡s\'': 't!s',
  'ts\'': 't!s',
  'tʃ': 'tx',
  't͡ʃ': 'tx',
  't͡ʂ': 'tX',
  'tʂ': 'tX',
  't͡ɕ': 'tx@',
  'tɕ': 'tx@',
  'v': 'v',
  'ʋ': 'V',
  'β': 'V',
  'vʲ': 'vy',
  'w': 'w',
  'ʍ': 'wh',
  'ɰ': 'W',
  'ɰ̃': 'W~',
  'ʃ': 'x',
  'ʂ': 'X',
  'ɕ': 'x@',
  'j': 'y',
  'ʝ': 'y',
  'y': 'y',
  'yː': 'yy',
  'jʱ': 'yhh',
  'j̃': 'y~',
  'z': 'z',
  'zʲ': 'zy',
  'ʔ': '\'',
  'ʕ': '"',
}

const look = list.reduce((m, data) => {
  m[data.doob] = '^' + data.doob.replace(/[\(\)\*\!\?\_\.\[\]\|\\\/]/g, _ => `\\${_}`)
  return m
}, {})

const form = (text, type) => {
  let remaining = text.replace(/[A-Z]/g, _ => _.toLowerCase() + '_')
  let output = []
  // return
  a:
  while (remaining.length) {
    b:
    for (let i = 0, n = list.length; i < n; i++) {
      const data = list[i]
      const pattern = look[data.doob]
      const regex = new RegExp(pattern)
      let match = remaining.match(regex)
      if (match) {
        output.push(data[type])
        remaining = remaining.substr(match[0].length)
        continue a
      }
    }
    break
  }
  return output.join('')
}

module.exports = form